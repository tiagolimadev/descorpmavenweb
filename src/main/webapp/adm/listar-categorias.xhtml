<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/layout/template.xhtml">
    <ui:define name="conteudo">

        <h:form id="listaCategoriasForm">

            <p:growl id="growl" autoUpdate="true" />
            
            <!-- Button Add Categoria -->
            <p:panelGrid id="addCat">
                <p:commandButton action="#{categoriaBean.initCategoria()}" oncomplete="PF('dlgCadCat').show();" icon="fa fa-fw fa-plus" value="Nova Categoria" update="formCadastrar" immediate="true" />
            </p:panelGrid>

            <!-- Form Datatable -->
            <p:panelGrid id="formDatatable" columns="2">

                <p:dataTable id="listaCategorias" value="#{categoriaBean.listaCategorias}" var="categoria" rowKey="#{categoria.id}"
                             paginator="true" paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                             rows="#{categoriaBean.linhas}">
                    <p:column headerText="Nome" sortBy="#{categoria.nome}">
                        <h:outputText value="#{categoria.nome}" />
                    </p:column>
                    <p:column headerText="Ações">
                        <p:commandButton action="#{categoriaBean.selecionarCategoria(categoria)}" oncomplete="PF('dlgEditCat').show();" value="Editar" icon="fa fa-fw fa-edit" update="atualizarForm" />
                        <p:commandButton action="#{categoriaBean.selecionarCategoria(categoria)}" oncomplete="PF('confRemCat').show();" value="Remover" icon="fa fa-fw fa-remove" />
                    </p:column>
                </p:dataTable>

            </p:panelGrid>
        </h:form>

        <h:form id="formCadastrar">
            <!-- Dialog Cadastrar Categoria -->
            <p:dialog header="Cadastrar Categoria" widgetVar="dlgCadCat" closeOnEscape="true" resizable="false">

                <div class="row">
                    <p:outputLabel value="Nome" for="nomeCad"/>
                    <p:inputText id="nomeCad" type="text" label="nomeCad" value="#{categoriaBean.categoria.nome}" />
                </div>

                <p:commandButton action="#{categoriaBean.cadastrarCategoria()}" oncomplete="PF('dlgCadCat').hide();" value="Cadastrar" icon="fa fa-fw fa-save" update="listaCategoriasForm" />
                <p:commandButton value="Cancelar" onclick="PF('dlgCadCat').hide();" type="button" />
            </p:dialog>
        </h:form>

        <h:form id="atualizarForm">
            <!-- Dialog Editar Categoria -->
            <p:dialog header="Editar Categoria" widgetVar="dlgEditCat" closeOnEscape="true" resizable="false">
                <div class="row">
                    <p:outputLabel value="Nome" for="nomeEdit"/>
                    <p:inputText id="nomeEdit" type="text" label="nomeEdit" value="#{categoriaBean.categoria.nome}" />
                </div>
                <p:commandButton action="#{categoriaBean.atualizarCategoria()}" oncomplete="PF('dlgEditCat').hide();" value="Atualizar" icon="fa fa-fw fa-edit" update="listaCategoriasForm" />
                <p:commandButton value="Cancelar" onclick="PF('dlgEditCat').hide();" type="button" />
            </p:dialog>
        </h:form>
        <h:form id="removerForm">
            <!-- ConfirmDialog Remoção de Categoria -->
            <p:confirmDialog message="Tem certeza que deseja remover a categoria?"
                             header="Confirmação de Remoção de Categoria" severity="alert"
                             widgetVar="confRemCat" closeOnEscape="true">
                <p:commandButton value="Sim" action="#{categoriaBean.removerCategoria()}" oncomplete="PF('confRemCat').hide()" update="listaCategoriasForm" />
                <p:commandButton value="Não" onclick="PF('confRemCat').hide();" type="button" />
            </p:confirmDialog>
        </h:form>

    </ui:define>
</ui:composition>
